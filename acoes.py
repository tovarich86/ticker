import streamlit as st
import requests
import pandas as pd
import yfinance as yf
from base64 import b64encode
from datetime import datetime, timedelta
import numpy as np
from arch import arch_model

# Lista de empresas
empresas =  [{'Nome de Preg√£o': '3R PETROLEUM',
  'Ticker': 'RRRP3',
  'CompanyName': '3R PETROLEUM √ìLEO E G√ÅS S.A'},
 {'Nome de Preg√£o': '524 PARTICIP',
  'Ticker': 'QVQP3B',
  'CompanyName': '524 PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'AERIS',
  'Ticker': 'AERI3',
  'CompanyName': 'AERIS IND. E COM. DE EQUIP. GERACAO DE ENERGIA S/A'},
 {'Nome de Preg√£o': 'AES BRASIL',
  'Ticker': 'AESB3',
  'CompanyName': 'AES BRASIL ENERGIA S.A.'},
 {'Nome de Preg√£o': 'AESOPERACOES',
  'Ticker': 'AESO3',
  'CompanyName': 'AES BRASIL OPERA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'AFLUENTE T',
  'Ticker': 'AFLT3',
  'CompanyName': 'AFLUENTE TRANSMISS√ÉO DE ENERGIA EL√âTRICA S/A'},
 {'Nome de Preg√£o': 'AGROGALAXY',
  'Ticker': 'AGXY3',
  'CompanyName': 'AGROGALAXY PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'ALFA HOLDING',
  'Ticker': 'RPAD3',
  'CompanyName': 'ALFA HOLDINGS S.A.'},
 {'Nome de Preg√£o': 'ALLIAR',
  'Ticker': 'AALR3',
  'CompanyName': 'ALLIAN√áA SA√öDE E PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'ALLIED',
  'Ticker': 'ALLD3',
  'CompanyName': 'ALLIED TECNOLOGIA S.A.'},
 {'Nome de Preg√£o': 'ALLOS', 'Ticker': 'ALOS3', 'CompanyName': 'ALLOS S.A'},
 {'Nome de Preg√£o': 'ESTAPAR',
  'Ticker': 'ALPK3',
  'CompanyName': 'ALLPARK EMPREENDIMENTOS PARTICIPACOES SERVICOS S.A'},
 {'Nome de Preg√£o': 'ALPARGATAS',
  'Ticker': 'ALPA3',
  'CompanyName': 'ALPARGATAS S.A.'},
 {'Nome de Preg√£o': 'ALPER S.A.',
  'Ticker': 'APER3',
  'CompanyName': 'ALPER CONSULTORIA E CORRETORA DE SEGUROS S.A.'},
 {'Nome de Preg√£o': 'ALPHAVILLE',
  'Ticker': 'AVLL3',
  'CompanyName': 'ALPHAVILLE S.A.'},
 {'Nome de Preg√£o': 'AMBEV S/A',
  'Ticker': 'ABEV3',
  'CompanyName': 'AMBEV S.A.'},
 {'Nome de Preg√£o': 'AMBIPAR',
  'Ticker': 'AMBP3',
  'CompanyName': 'AMBIPAR PARTICIPACOES E EMPREENDIMENTOS S/A'},
 {'Nome de Preg√£o': 'AMERICANAS',
  'Ticker': 'AMER3',
  'CompanyName': 'AMERICANAS S.A'},
 {'Nome de Preg√£o': 'AMPLA ENERG',
  'Ticker': 'CBEE3',
  'CompanyName': 'AMPLA ENERGIA E SERVICOS S.A.'},
 {'Nome de Preg√£o': 'ANIMA',
  'Ticker': 'ANIM3',
  'CompanyName': 'ANIMA HOLDING S.A.'},
 {'Nome de Preg√£o': 'AREZZO CO',
  'Ticker': 'ARZZ3',
  'CompanyName': 'AREZZO IND√öSTRIA E COM√âRCIO S.A.'},
 {'Nome de Preg√£o': 'ARMAC',
  'Ticker': 'ARML3',
  'CompanyName': 'ARMAC LOCA√á√ÉO. LOG√çSTICA E SERVI√áOS S.A.'},
 {'Nome de Preg√£o': 'CARREFOUR BR',
  'Ticker': 'CRFB3',
  'CompanyName': 'ATACAD√ÉO S.A.'},
 {'Nome de Preg√£o': 'ATMASA',
  'Ticker': 'ATMP3',
  'CompanyName': 'ATMA PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'ATOMPAR',
  'Ticker': 'ATOM3',
  'CompanyName': 'ATOM EMPREENDIMENTOS E PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'KLABIN SA',
  'Ticker': 'KLBN11',
  'CompanyName': 'KLABIN S.A.'},
 {'Nome de Preg√£o': 'AUREN',
  'Ticker': 'AURE3',
  'CompanyName': 'AUREN ENERGIA S.A.'},
 {'Nome de Preg√£o': 'AZEVEDO',
  'Ticker': 'AZEV3',
  'CompanyName': 'AZEVEDO E TRAVASSOS S.A.'},
 {'Nome de Preg√£o': 'AZUL', 'Ticker': 'AZUL4', 'CompanyName': 'AZUL S.A.'},
 {'Nome de Preg√£o': 'B3',
  'Ticker': 'B3SA3',
  'CompanyName': 'B3 S.A. - BRASIL. BOLSA. BALC√ÉO'},
 {'Nome de Preg√£o': 'BAHEMA',
  'Ticker': 'BAHI3',
  'CompanyName': 'BAHEMA EDUCA√á√ÉO S.A.'},
 {'Nome de Preg√£o': 'BANCO BMG',
  'Ticker': 'BMGB4',
  'CompanyName': 'BANCO BMG S.A.'},
 {'Nome de Preg√£o': 'BANESTES',
  'Ticker': 'BEES3',
  'CompanyName': 'BANESTES S.A. - BCO EST ESPIRITO SANTO'},
 {'Nome de Preg√£o': 'BARDELLA',
  'Ticker': 'BDLL3',
  'CompanyName': 'BARDELLA S.A. INDUSTRIAS MECANICAS'},
 {'Nome de Preg√£o': 'BAUMER', 'Ticker': 'BALM3', 'CompanyName': 'BAUMER S.A.'},
 {'Nome de Preg√£o': 'BBSEGURIDADE',
  'Ticker': 'BBSE3',
  'CompanyName': 'BB SEGURIDADE PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'BBMLOGISTICA',
  'Ticker': 'BBM',
  'CompanyName': 'BBM LOGISTICA S.A.'},
 {'Nome de Preg√£o': 'ABC BRASIL',
  'Ticker': 'ABCB4',
  'CompanyName': 'BCO ABC BRASIL S.A.'},
 {'Nome de Preg√£o': 'ALFA INVEST',
  'Ticker': 'BRIV3',
  'CompanyName': 'BCO ALFA DE INVESTIMENTO S.A.'},
 {'Nome de Preg√£o': 'AMAZONIA',
  'Ticker': 'BAZA3',
  'CompanyName': 'BCO AMAZONIA S.A.'},
 {'Nome de Preg√£o': 'BRADESCO',
  'Ticker': 'BBDC3',
  'CompanyName': 'BCO BRADESCO S.A.'},
 {'Nome de Preg√£o': 'BRASIL',
  'Ticker': 'BBAS3',
  'CompanyName': 'BCO BRASIL S.A.'},
 {'Nome de Preg√£o': 'BANESE',
  'Ticker': 'BGIP3',
  'CompanyName': 'BCO ESTADO DE SERGIPE S.A. - BANESE'},
 {'Nome de Preg√£o': 'BANPARA',
  'Ticker': 'BPAR3',
  'CompanyName': 'BCO ESTADO DO PARA S.A.'},
 {'Nome de Preg√£o': 'BANRISUL',
  'Ticker': 'BRSR3',
  'CompanyName': 'BCO ESTADO DO RIO GRANDE DO SUL S.A.'},
 {'Nome de Preg√£o': 'MERC INVEST',
  'Ticker': 'BMIN3',
  'CompanyName': 'BCO MERCANTIL DE INVESTIMENTOS S.A.'},
 {'Nome de Preg√£o': 'MERCANTIL',
  'Ticker': 'BMEB3',
  'CompanyName': 'BCO MERCANTIL DO BRASIL S.A.'},
 {'Nome de Preg√£o': 'NORD BRASIL',
  'Ticker': 'BNBR3',
  'CompanyName': 'BCO NORDESTE DO BRASIL S.A.'},
 {'Nome de Preg√£o': 'BANCO PAN',
  'Ticker': 'BPAN4',
  'CompanyName': 'BCO PAN S.A.'},
 {'Nome de Preg√£o': 'PINE', 'Ticker': 'PINE3', 'CompanyName': 'BCO PINE S.A.'},
 {'Nome de Preg√£o': 'BEMOBI TECH',
  'Ticker': 'BMOB3',
  'CompanyName': 'BEMOBI MOBILE TECH S.A.'},
 {'Nome de Preg√£o': 'BETAPART',
  'Ticker': 'BETP3B',
  'CompanyName': 'BETAPART PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'BIC MONARK',
  'Ticker': 'BMKS3',
  'CompanyName': 'BICICLETAS MONARK S.A.'},
 {'Nome de Preg√£o': 'BIOMM', 'Ticker': 'BIOM3', 'CompanyName': 'BIOMM S.A.'},
 {'Nome de Preg√£o': 'BLAU',
  'Ticker': 'BLAU3',
  'CompanyName': 'BLAU FARMAC√äUTICA S.A.'},
 {'Nome de Preg√£o': 'BOA SAFRA',
  'Ticker': 'SOJA3',
  'CompanyName': 'BOA SAFRA SEMENTES S.A.'},
 {'Nome de Preg√£o': 'BOMBRIL',
  'Ticker': 'BOBR3',
  'CompanyName': 'BOMBRIL S.A.'},
 {'Nome de Preg√£o': 'VIPAL',
  'Ticker': 0,
  'CompanyName': 'BORRACHAS VIPAL S.A.'},
 {'Nome de Preg√£o': 'BR MALLS PAR',
  'Ticker': 'BRML3',
  'CompanyName': 'BR MALLS PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'BRADESPAR',
  'Ticker': 'BRAP3',
  'CompanyName': 'BRADESPAR S.A.'},
 {'Nome de Preg√£o': 'BRASILAGRO',
  'Ticker': 'AGRO3',
  'CompanyName': 'BRASILAGRO - CIA BRAS DE PROP AGRICOLAS'},
 {'Nome de Preg√£o': 'BRASKEM',
  'Ticker': 'BRKM3',
  'CompanyName': 'BRASKEM S.A.'},
 {'Nome de Preg√£o': 'BRB BANCO',
  'Ticker': 'BSLI3',
  'CompanyName': 'BRB BCO DE BRASILIA S.A.'},
 {'Nome de Preg√£o': 'BRF SA', 'Ticker': 'BRFS3', 'CompanyName': 'BRF S.A.'},
 {'Nome de Preg√£o': 'BRISANET',
  'Ticker': 'BRIT3',
  'CompanyName': 'BRISANET PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'BRQ',
  'Ticker': 'BRQB',
  'CompanyName': 'BRQ SOLUCOES EM INFORMATICA S.A.'},
 {'Nome de Preg√£o': 'CABINDA PART',
  'Ticker': 0,
  'CompanyName': 'CABINDA PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'CAIXA SEGURI',
  'Ticker': 'CXSE3',
  'CompanyName': 'CAIXA SEGURIDADE PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'CAMBUCI',
  'Ticker': 'CAMB3',
  'CompanyName': 'CAMBUCI S.A.'},
 {'Nome de Preg√£o': 'CAMIL',
  'Ticker': 'CAML3',
  'CompanyName': 'CAMIL ALIMENTOS S.A.'},
 {'Nome de Preg√£o': 'CCR SA', 'Ticker': 'CCRO3', 'CompanyName': 'CCR S.A.'},
 {'Nome de Preg√£o': 'CEA MODAS',
  'Ticker': 'CEAB3',
  'CompanyName': 'CEA MODAS S.A.'},
 {'Nome de Preg√£o': 'CEMEPE',
  'Ticker': 713854,
  'CompanyName': 'CEMEPE INVESTIMENTOS S.A.'},
 {'Nome de Preg√£o': 'ELETROBRAS',
  'Ticker': 'ELET3',
  'CompanyName': 'CENTRAIS ELET BRAS S.A. - ELETROBRAS'},
 {'Nome de Preg√£o': 'CELESC',
  'Ticker': 'CLSC3',
  'CompanyName': 'CENTRAIS ELET DE SANTA CATARINA S.A.'},
 {'Nome de Preg√£o': 'P.ACUCAR-CBD',
  'Ticker': 'PCAR3',
  'CompanyName': 'CIA BRASILEIRA DE DISTRIBUICAO'},
 {'Nome de Preg√£o': 'CASAN',
  'Ticker': 'CASN3',
  'CompanyName': 'CIA CATARINENSE DE AGUAS E SANEAM.-CASAN'},
 {'Nome de Preg√£o': 'CELGPAR',
  'Ticker': 'GPAR3',
  'CompanyName': 'CIA CELG DE PARTICIPACOES - CELGPAR'},
 {'Nome de Preg√£o': 'CEG',
  'Ticker': 'CEGR3',
  'CompanyName': 'CIA DISTRIB DE GAS DO RIO DE JANEIRO-CEG'},
 {'Nome de Preg√£o': 'COELBA',
  'Ticker': 'CEEB3',
  'CompanyName': 'CIA ELETRICIDADE EST. DA BAHIA - COELBA'},
 {'Nome de Preg√£o': 'CEB',
  'Ticker': 'CEBR3',
  'CompanyName': 'CIA ENERGETICA DE BRASILIA'},
 {'Nome de Preg√£o': 'CEMIG',
  'Ticker': 'CMIG3',
  'CompanyName': 'CIA ENERGETICA DE MINAS GERAIS - CEMIG'},
 {'Nome de Preg√£o': 'COELCE',
  'Ticker': 'COCE3',
  'CompanyName': 'CIA ENERGETICA DO CEARA - COELCE'},
 {'Nome de Preg√£o': 'COSERN',
  'Ticker': 'CSRN3',
  'CompanyName': 'CIA ENERGETICA DO RIO GDE NORTE - COSERN'},
 {'Nome de Preg√£o': 'CEEE-D',
  'Ticker': 'CEED3',
  'CompanyName': 'CIA ESTADUAL DE DISTRIB ENER ELET-CEEE-D'},
 {'Nome de Preg√£o': 'CEEE-G',
  'Ticker': 'CGEE3',
  'CompanyName': 'CIA ESTADUAL DE GERA√á√ÉO DE ENERGIA EL√âTRICA-CEEE-G'},
 {'Nome de Preg√£o': 'FERBASA',
  'Ticker': 'FESA3',
  'CompanyName': 'CIA FERRO LIGAS DA BAHIA - FERBASA'},
 {'Nome de Preg√£o': 'CEDRO',
  'Ticker': 'CEDO3',
  'CompanyName': 'CIA FIACAO TECIDOS CEDRO CACHOEIRA'},
 {'Nome de Preg√£o': 'COMGAS',
  'Ticker': 'CGAS3',
  'CompanyName': 'CIA GAS DE SAO PAULO - COMGAS'},
 {'Nome de Preg√£o': 'HABITASUL',
  'Ticker': 'HBTS5',
  'CompanyName': 'CIA HABITASUL DE PARTICIPACOES'},
 {'Nome de Preg√£o': 'CHESF',
  'Ticker': 0,
  'CompanyName': 'CIA HIDRO ELETRICA DO SAO FRANCISCO - CHESF'},
 {'Nome de Preg√£o': 'IND CATAGUAS',
  'Ticker': 'CATA3',
  'CompanyName': 'CIA INDUSTRIAL CATAGUASES'},
 {'Nome de Preg√£o': 'LOCAMERICA',
  'Ticker': 'LCAM3',
  'CompanyName': 'CIA LOCA√á√ÉO DAS AM√âRICAS'},
 {'Nome de Preg√£o': 'MELHOR SP',
  'Ticker': 0,
  'CompanyName': 'CIA MELHORAMENTOS DE SAO PAULO'},
 {'Nome de Preg√£o': 'COPEL',
  'Ticker': 'CPLE3',
  'CompanyName': 'CIA PARANAENSE DE ENERGIA - COPEL'},
 {'Nome de Preg√£o': 'PAR AL BAHIA',
  'Ticker': 'PEAB3',
  'CompanyName': 'CIA PARTICIPACOES ALIANCA DA BAHIA'},
 {'Nome de Preg√£o': 'SABESP',
  'Ticker': 'SBSP3',
  'CompanyName': 'CIA SANEAMENTO BASICO EST SAO PAULO'},
 {'Nome de Preg√£o': 'COPASA',
  'Ticker': 'CSMG3',
  'CompanyName': 'CIA SANEAMENTO DE MINAS GERAIS-COPASA MG'},
 {'Nome de Preg√£o': 'SANEPAR',
  'Ticker': 'SAPR3',
  'CompanyName': 'CIA SANEAMENTO DO PARANA - SANEPAR'},
 {'Nome de Preg√£o': 'SID NACIONAL',
  'Ticker': 'CSNA3',
  'CompanyName': 'CIA SIDERURGICA NACIONAL'},
 {'Nome de Preg√£o': 'COTEMINAS',
  'Ticker': 'CTNM3',
  'CompanyName': 'CIA TECIDOS NORTE DE MINAS COTEMINAS'},
 {'Nome de Preg√£o': 'SANTANENSE',
  'Ticker': 'CTSA3',
  'CompanyName': 'CIA TECIDOS SANTANENSE'},
 {'Nome de Preg√£o': 'CIELO',
  'Ticker': 'CIEL3',
  'CompanyName': 'CIELO S.A. - INSTITUI√á√ÉO DE PAGAMENTO'},
 {'Nome de Preg√£o': 'CIMS', 'Ticker': 'CMFA3', 'CompanyName': 'CIMS S.A.'},
 {'Nome de Preg√£o': 'CLEARSALE',
  'Ticker': 'CLSA3',
  'CompanyName': 'CLEAR SALE S.A.'},
 {'Nome de Preg√£o': 'VIVEO',
  'Ticker': 'VVEO3',
  'CompanyName': 'CM HOSPITALAR S.A.'},
 {'Nome de Preg√£o': 'COGNA ON',
  'Ticker': 'COGN3',
  'CompanyName': 'COGNA EDUCA√á√ÉO S.A.'},
 {'Nome de Preg√£o': 'COMERC PAR',
  'Ticker': 0,
  'CompanyName': 'COMERC ENERGIA S.A.'},
 {'Nome de Preg√£o': 'CBA',
  'Ticker': 'CBAV3',
  'CompanyName': 'COMPANHIA BRASILEIRA DE ALUM√çNIO'},
 {'Nome de Preg√£o': 'COMPASS',
  'Ticker': 'PASS3',
  'CompanyName': 'COMPASS GAS E ENERGIA S.A.'},
 {'Nome de Preg√£o': 'ODERICH',
  'Ticker': 'ODER3',
  'CompanyName': 'CONSERVAS ODERICH S.A.'},
 {'Nome de Preg√£o': 'ALFA CONSORC',
  'Ticker': 'BRGE3',
  'CompanyName': 'CONSORCIO ALFA DE ADMINISTRACAO S.A.'},
 {'Nome de Preg√£o': 'CONST A LIND',
  'Ticker': 'CALI3',
  'CompanyName': 'CONSTRUTORA ADOLPHO LINDENBERG S.A.'},
 {'Nome de Preg√£o': 'TENDA',
  'Ticker': 'TEND3',
  'CompanyName': 'CONSTRUTORA TENDA S.A.'},
 {'Nome de Preg√£o': 'COSAN', 'Ticker': 'CSAN3', 'CompanyName': 'COSAN S.A.'},
 {'Nome de Preg√£o': 'CPFL ENERGIA',
  'Ticker': 'CPFE3',
  'CompanyName': 'CPFL ENERGIA S.A.'},
 {'Nome de Preg√£o': 'MERC FINANC',
  'Ticker': 'MERC3',
  'CompanyName': 'MERCANTIL FINANCEIRA S.A. \x96 CRED. FINANC. E INVEST'},
 {'Nome de Preg√£o': 'CRUZEIRO EDU',
  'Ticker': 'CSED3',
  'CompanyName': 'CRUZEIRO DO SUL EDUCACIONAL S.A.'},
 {'Nome de Preg√£o': 'CSNMINERACAO',
  'Ticker': 25585,
  'CompanyName': 'CSN MINERA√á√ÉO S.A.'},
 {'Nome de Preg√£o': 'CSU DIGITAL',
  'Ticker': 'CSUD3',
  'CompanyName': 'CSU DIGITAL S.A.'},
 {'Nome de Preg√£o': 'CTC S.A.',
  'Ticker': 'CTCA3',
  'CompanyName': 'CTC - CENTRO DE TECNOLOGIA CANAVIEIRA S.A.'},
 {'Nome de Preg√£o': 'TRAN PAULIST',
  'Ticker': 'TRPL3',
  'CompanyName': 'CTEEP - CIA TRANSMISS√ÉO ENERGIA EL√âTRICA PAULISTA'},
 {'Nome de Preg√£o': 'CURY S/A',
  'Ticker': 'CURY3',
  'CompanyName': 'CURY CONSTRUTORA E INCORPORADORA S.A.'},
 {'Nome de Preg√£o': 'CVC BRASIL',
  'Ticker': 'CVCB3',
  'CompanyName': 'CVC BRASIL OPERADORA E AG√äNCIA DE VIAGENS S.A.'},
 {'Nome de Preg√£o': 'CYRELA REALT',
  'Ticker': 'CYRE3',
  'CompanyName': 'CYRELA BRAZIL REALTY S.A.EMPREEND E PART'},
 {'Nome de Preg√£o': 'D1000VFARMA',
  'Ticker': 'DMVF3',
  'CompanyName': 'D1000 VAREJO FARMA PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'DESKTOP',
  'Ticker': 'DESK3',
  'CompanyName': 'DESKTOP S.A.'},
 {'Nome de Preg√£o': 'DEXCO', 'Ticker': 'DXCO3', 'CompanyName': 'DEXCO S.A.'},
 {'Nome de Preg√£o': 'DEXXOS PAR',
  'Ticker': 'DEXP3',
  'CompanyName': 'DEXXOS PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'DASA',
  'Ticker': 'DASA3',
  'CompanyName': 'DIAGNOSTICOS DA AMERICA S.A.'},
 {'Nome de Preg√£o': 'DIMED',
  'Ticker': 'PNVL3',
  'CompanyName': 'DIMED S.A. DISTRIBUIDORA DE MEDICAMENTOS'},
 {'Nome de Preg√£o': 'DIRECIONAL',
  'Ticker': 'DIRR3',
  'CompanyName': 'DIRECIONAL ENGENHARIA S.A.'},
 {'Nome de Preg√£o': 'DMFINANCEIRA',
  'Ticker': 'DMFN3',
  'CompanyName': 'DM FINANCEIRA S.A. - CR√âDITO. FINANC E INVEST'},
 {'Nome de Preg√£o': 'DOHLER', 'Ticker': 'DOHL3', 'CompanyName': 'DOHLER S.A.'},
 {'Nome de Preg√£o': 'DOTZ SA', 'Ticker': 'DOTZ3', 'CompanyName': 'DOTZ S.A.'},
 {'Nome de Preg√£o': 'DTCOM-DIRECT',
  'Ticker': 'DTCY3',
  'CompanyName': 'DTCOM - DIRECT TO COMPANY S.A.'},
 {'Nome de Preg√£o': 'ECORODOVIAS',
  'Ticker': 'ECOR3',
  'CompanyName': 'ECORODOVIAS INFRAESTRUTURA E LOG√çSTICA S.A.'},
 {'Nome de Preg√£o': 'ACO ALTONA',
  'Ticker': 'EALT3',
  'CompanyName': 'ELECTRO ACO ALTONA S.A.'},
 {'Nome de Preg√£o': 'ELEKTRO',
  'Ticker': 'EKTR3',
  'CompanyName': 'ELEKTRO REDES S.A.'},
 {'Nome de Preg√£o': 'ELETROPAR',
  'Ticker': 'LIPR3',
  'CompanyName': 'ELETROBR√ÅS PARTICIPA√á√ïES S.A. - ELETROPAR'},
 {'Nome de Preg√£o': 'ELETROMIDIA',
  'Ticker': 'ELMD3',
  'CompanyName': 'ELETROMIDIA S.A.'},
 {'Nome de Preg√£o': 'EMAE',
  'Ticker': 'EMAE3',
  'CompanyName': 'EMAE - EMPRESA METROP.AGUAS ENERGIA S.A.'},
 {'Nome de Preg√£o': 'EMBPAR S/A',
  'Ticker': '1545-8',
  'CompanyName': 'EMBPAR PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'EMBRAER',
  'Ticker': 'EMBR3',
  'CompanyName': 'EMBRAER S.A.'},
 {'Nome de Preg√£o': 'PAGUE MENOS',
  'Ticker': 'PGMN3',
  'CompanyName': 'EMPREENDIMENTOS PAGUE MENOS S.A.'},
 {'Nome de Preg√£o': 'ENAUTA PART',
  'Ticker': 'ENAT3',
  'CompanyName': 'ENAUTA PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'ENERGISA MT',
  'Ticker': 'ENMT3',
  'CompanyName': 'ENERGISA MATO GROSSO-DISTRIBUIDORA DE ENERGIA S/A'},
 {'Nome de Preg√£o': 'ENERGISA',
  'Ticker': 'ENGI3',
  'CompanyName': 'ENERGISA S.A.'},
 {'Nome de Preg√£o': 'ENEVA', 'Ticker': 'ENEV3', 'CompanyName': 'ENEVA S.A'},
 {'Nome de Preg√£o': 'ENGIE BRASIL',
  'Ticker': 'EGIE3',
  'CompanyName': 'ENGIE BRASIL ENERGIA S.A.'},
 {'Nome de Preg√£o': 'ENJOEI', 'Ticker': 'ENJU3', 'CompanyName': 'ENJOEI S.A.'},
 {'Nome de Preg√£o': 'ENVIRONMENT',
  'Ticker': 0,
  'CompanyName': 'ENVIRONMENTAL ESG PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'EQUATORIAL',
  'Ticker': 'EQTL3',
  'CompanyName': 'EQUATORIAL ENERGIA S.A.'},
 {'Nome de Preg√£o': 'EQTLMARANHAO',
  'Ticker': 'ENMA3B',
  'CompanyName': 'EQUATORIAL MARANH√ÉO DISTRIBUIDORA DE ENERGIA S.A.'},
 {'Nome de Preg√£o': 'EQTL PARA',
  'Ticker': 'CELP3',
  'CompanyName': 'EQUATORIAL PARA DISTRIBUIDORA DE ENERGIA S.A.'},
 {'Nome de Preg√£o': 'ETERNIT',
  'Ticker': 'ETER3',
  'CompanyName': 'ETERNIT S.A.'},
 {'Nome de Preg√£o': 'EUCATEX',
  'Ticker': 'EUCA3',
  'CompanyName': 'EUCATEX S.A. INDUSTRIA E COMERCIO'},
 {'Nome de Preg√£o': 'EUROFARMA SA',
  'Ticker': 'EUFA',
  'CompanyName': 'EUROFARMA LABORATORIOS S.A'},
 {'Nome de Preg√£o': 'EVEN',
  'Ticker': 'EVEN3',
  'CompanyName': 'EVEN CONSTRUTORA E INCORPORADORA S.A.'},
 {'Nome de Preg√£o': 'EXCELSIOR',
  'Ticker': 'BAUH3',
  'CompanyName': 'EXCELSIOR ALIMENTOS S.A.'},
 {'Nome de Preg√£o': 'EZTEC',
  'Ticker': 'EZTC3',
  'CompanyName': 'EZ TEC EMPREEND. E PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'NISSEI FARMA',
  'Ticker': 0,
  'CompanyName': 'FARM√ÅCIA E DROGARIA NISSEI S.A.'},
 {'Nome de Preg√£o': 'FER C ATLANT',
  'Ticker': 'VSPT3',
  'CompanyName': 'FERROVIA CENTRO-ATLANTICA S.A.'},
 {'Nome de Preg√£o': 'FER HERINGER',
  'Ticker': 'FHER3',
  'CompanyName': 'FERTILIZANTES HERINGER S.A.'},
 {'Nome de Preg√£o': 'FICA',
  'Ticker': 'CRDE3',
  'CompanyName': 'FICA EMPREENDIMENTOS IMOBILI√ÅRIOS S.A'},
 {'Nome de Preg√£o': 'ALFA FINANC',
  'Ticker': 'CRIV3',
  'CompanyName': 'FINANCEIRA ALFA S.A.- CRED FINANC E INVS'},
 {'Nome de Preg√£o': 'FLEURY', 'Ticker': 'FLRY3', 'CompanyName': 'FLEURY S.A.'},
 {'Nome de Preg√£o': 'FRAS-LE',
  'Ticker': 'FRAS3',
  'CompanyName': 'FRAS-LE S.A.'},
 {'Nome de Preg√£o': 'GAFISA', 'Ticker': 'GFSA3', 'CompanyName': 'GAFISA S.A.'},
 {'Nome de Preg√£o': 'GAMA PART',
  'Ticker': 'OPGM3B',
  'CompanyName': 'GAMA PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'GENERALSHOPP',
  'Ticker': 'GSHP3',
  'CompanyName': 'GENERAL SHOPPING E OUTLETS DO BRASIL S.A.'},
 {'Nome de Preg√£o': 'GERDAU', 'Ticker': 'GGBR3', 'CompanyName': 'GERDAU S.A.'},
 {'Nome de Preg√£o': 'GETNINJAS',
  'Ticker': 'NINJ3',
  'CompanyName': 'GETNINJAS S.A.'},
 {'Nome de Preg√£o': 'GOL',
  'Ticker': 'GOLL4',
  'CompanyName': 'GOL LINHAS AEREAS INTELIGENTES S.A.'},
 {'Nome de Preg√£o': 'GPS',
  'Ticker': 'GGPS3',
  'CompanyName': 'GPS PARTICIPACOES E EMPREENDIMENTOS S.A.'},
 {'Nome de Preg√£o': 'GRAZZIOTIN',
  'Ticker': 'CGRA3',
  'CompanyName': 'GRAZZIOTIN S.A.'},
 {'Nome de Preg√£o': 'GRENDENE',
  'Ticker': 'GRND3',
  'CompanyName': 'GRENDENE S.A.'},
 {'Nome de Preg√£o': 'CASAS BAHIA',
  'Ticker': 'BHIA3',
  'CompanyName': 'GRUPO CASAS BAHIA S.A.'},
 {'Nome de Preg√£o': 'GRUPO SOMA',
  'Ticker': 'SOMA3',
  'CompanyName': 'GRUPO DE MODA SOMA S.A.'},
 {'Nome de Preg√£o': 'GRUPO MATEUS',
  'Ticker': 'GMAT3',
  'CompanyName': 'GRUPO MATEUS S.A.'},
 {'Nome de Preg√£o': 'GRUPO SBF',
  'Ticker': 'SBFG3',
  'CompanyName': 'GRUPO SBF SA'},
 {'Nome de Preg√£o': 'GUARARAPES',
  'Ticker': 'GUAR3',
  'CompanyName': 'GUARARAPES CONFECCOES S.A.'},
 {'Nome de Preg√£o': 'HAGA S/A',
  'Ticker': 2,
  'CompanyName': 'HAGA S.A. INDUSTRIA E COMERCIO'},
 {'Nome de Preg√£o': 'HAPVIDA',
  'Ticker': 'HAPV3',
  'CompanyName': 'HAPVIDA PARTICIPACOES E INVESTIMENTOS SA'},
 {'Nome de Preg√£o': 'HBR REALTY',
  'Ticker': 'HBRE3',
  'CompanyName': 'HBR REALTY EMPREENDIMENTOS IMOBILIARIOS S/A'},
 {'Nome de Preg√£o': 'HELBOR',
  'Ticker': 'HBOR3',
  'CompanyName': 'HELBOR EMPREENDIMENTOS S.A.'},
 {'Nome de Preg√£o': 'HERCULES',
  'Ticker': 'HETA3',
  'CompanyName': 'HERCULES S.A. FABRICA DE TALHERES'},
 {'Nome de Preg√£o': 'HIDROVIAS',
  'Ticker': 'HBSA3',
  'CompanyName': 'HIDROVIAS DO BRASIL S.A.'},
 {'Nome de Preg√£o': 'HMOBI S.A',
  'Ticker': 'HMOB3',
  'CompanyName': 'HMOBI PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'HOSPITALCARE',
  'Ticker': 0,
  'CompanyName': 'HOSPITAL CARE CALEDONIA S.A.'},
 {'Nome de Preg√£o': 'MATER DEI',
  'Ticker': 'MATD3',
  'CompanyName': 'HOSPITAL MATER DEI S/A'},
 {'Nome de Preg√£o': 'HOTEIS OTHON',
  'Ticker': 'HOOT4',
  'CompanyName': 'HOTEIS OTHON S.A.'},
 {'Nome de Preg√£o': 'AGRIBRASIL',
  'Ticker': 'GRAO3',
  'CompanyName': 'HUMBERG AGRIBRASIL COM. E EXPORT. DE GR√ÉOS S.A.'},
 {'Nome de Preg√£o': 'HYPERA', 'Ticker': 'HYPE3', 'CompanyName': 'HYPERA S.A.'},
 {'Nome de Preg√£o': 'IGUA SA',
  'Ticker': 'IGSN3',
  'CompanyName': 'IGUA SANEAMENTO S.A.'},
 {'Nome de Preg√£o': 'IGUATEMI',
  'Ticker': 'IGTA3',
  'CompanyName': 'IGUATEMI EMPRESA DE SHOPPING CENTERS S.A'},
 {'Nome de Preg√£o': 'IGUATEMI S.A',
  'Ticker': 'IGTI3',
  'CompanyName': 'IGUATEMI S.A.'},
 {'Nome de Preg√£o': 'INC SA',
  'Ticker': 'INNT3',
  'CompanyName': 'INC EMPREENDIMENTOS IMOBILI√ÅRIOS S.A.'},
 {'Nome de Preg√£o': 'INEPAR',
  'Ticker': 'INEP3',
  'CompanyName': 'INEPAR S.A. INDUSTRIA E CONSTRUCOES'},
 {'Nome de Preg√£o': 'INFRACOMM',
  'Ticker': 'IFCM3',
  'CompanyName': 'INFRACOMMERCE CXAAS S.A.'},
 {'Nome de Preg√£o': 'INTELBRAS',
  'Ticker': 'INTB3',
  'CompanyName': 'INTELBRAS S.A. IND DE TELEC ELETRONICA BRASILEIRA'},
 {'Nome de Preg√£o': 'IMC S/A',
  'Ticker': 'MEAL3',
  'CompanyName': 'INTERNATIONAL MEAL COMPANY ALIMENTACAO S.A.'},
 {'Nome de Preg√£o': 'INVEST BEMGE',
  'Ticker': 'FIGE3',
  'CompanyName': 'INVESTIMENTOS BEMGE S.A.'},
 {'Nome de Preg√£o': 'INVEPAR',
  'Ticker': 'IVPR3',
  'CompanyName': 'INVESTIMENTOS E PARTICIP. EM INFRA S.A. - INVEPAR'},
 {'Nome de Preg√£o': 'IOCHP-MAXION',
  'Ticker': 'MYPK3',
  'CompanyName': 'IOCHPE MAXION S.A.'},
 {'Nome de Preg√£o': 'IRANI',
  'Ticker': 'RANI3',
  'CompanyName': 'IRANI PAPEL E EMBALAGEM S.A.'},
 {'Nome de Preg√£o': 'IRBBRASIL RE',
  'Ticker': 'IRBR3',
  'CompanyName': 'IRB - BRASIL RESSEGUROS S.A.'},
 {'Nome de Preg√£o': 'ITAUUNIBANCO',
  'Ticker': 'ITUB3',
  'CompanyName': 'ITAU UNIBANCO HOLDING S.A.'},
 {'Nome de Preg√£o': 'ITAUSA', 'Ticker': 'ITSA3', 'CompanyName': 'ITAUSA S.A.'},
 {'Nome de Preg√£o': 'JALLESMACHAD',
  'Ticker': 'JALL3',
  'CompanyName': 'JALLES MACHADO S.A.'},
 {'Nome de Preg√£o': 'JBS', 'Ticker': 'JBSS3', 'CompanyName': 'JBS S.A.'},
 {'Nome de Preg√£o': 'JHSF PART',
  'Ticker': 'JHSF3',
  'CompanyName': 'JHSF PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'JOAO FORTES',
  'Ticker': 'JFEN3',
  'CompanyName': 'JOAO FORTES ENGENHARIA S.A.'},
 {'Nome de Preg√£o': 'JOSAPAR',
  'Ticker': 'JOPA3',
  'CompanyName': 'JOSAPAR-JOAQUIM OLIVEIRA S.A. - PARTICIP'},
 {'Nome de Preg√£o': 'JSL', 'Ticker': 'JSLG3', 'CompanyName': 'JSL S.A.'},
 {'Nome de Preg√£o': 'KALLAS',
  'Ticker': 'KLAS3',
  'CompanyName': 'KALLAS INCORPORACOES E CONSTRUCOES S.A.'},
 {'Nome de Preg√£o': 'KARSTEN',
  'Ticker': 'CTKA3',
  'CompanyName': 'KARSTEN S.A.'},
 {'Nome de Preg√£o': 'KEPLER WEBER',
  'Ticker': 'KEPL3',
  'CompanyName': 'KEPLER WEBER S.A.'},
 {'Nome de Preg√£o': 'KORA SAUDE',
  'Ticker': 'KRSA3',
  'CompanyName': 'KORA SA√öDE PARTICIPA√á√ïES S.A'},
 {'Nome de Preg√£o': 'LAVVI',
  'Ticker': 'LAVV3',
  'CompanyName': 'LAVVI EMPREENDIMENTOS IMOBILI√ÅRIOS S.A.'},
 {'Nome de Preg√£o': 'LIFEMED',
  'Ticker': 'LMED',
  'CompanyName': 'LIFEMED INDUSTRIAL EQUIP. DE ART. M√âD. HOSP. S.A.'},
 {'Nome de Preg√£o': 'LIGHT S/A',
  'Ticker': 'LIGT3',
  'CompanyName': 'LIGHT S.A.'},
 {'Nome de Preg√£o': 'LITEL',
  'Ticker': 'LTEL3B',
  'CompanyName': 'LITEL PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'LITELA',
  'Ticker': 'LTLA',
  'CompanyName': 'LITELA PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'LOCALIZA',
  'Ticker': 'RENT3',
  'CompanyName': 'LOCALIZA RENT A CAR S.A.'},
 {'Nome de Preg√£o': 'LWSA',
  'Ticker': 'LWSA3',
  'CompanyName': 'LOCAWEB SERVI√áOS DE INTERNET S.A.'},
 {'Nome de Preg√£o': 'LOG COM PROP',
  'Ticker': 'LOGG3',
  'CompanyName': 'LOG COMMERCIAL PROPERTIES'},
 {'Nome de Preg√£o': 'LOG-IN',
  'Ticker': 'LOGN3',
  'CompanyName': 'LOG-IN LOGISTICA INTERMODAL S.A.'},
 {'Nome de Preg√£o': 'QUERO-QUERO',
  'Ticker': 'LJQQ3',
  'CompanyName': 'LOJAS QUERO-QUERO S/A'},
 {'Nome de Preg√£o': 'LOJAS RENNER',
  'Ticker': 'LREN3',
  'CompanyName': 'LOJAS RENNER S.A.'},
 {'Nome de Preg√£o': 'LOPES BRASIL',
  'Ticker': 'LPSB3',
  'CompanyName': 'LPS BRASIL - CONSULTORIA DE IMOVEIS S.A.'},
 {'Nome de Preg√£o': 'LUPATECH',
  'Ticker': 'LUPA3',
  'CompanyName': 'LUPATECH S.A.'},
 {'Nome de Preg√£o': 'M.DIASBRANCO',
  'Ticker': 'MDIA3',
  'CompanyName': 'M.DIAS BRANCO S.A. IND COM DE ALIMENTOS'},
 {'Nome de Preg√£o': 'MAESTROLOC',
  'Ticker': 'MSRO3',
  'CompanyName': 'MAESTRO LOCADORA DE VEICULOS S.A.'},
 {'Nome de Preg√£o': 'MAGAZ LUIZA',
  'Ticker': 'MGLU3',
  'CompanyName': 'MAGAZINE LUIZA S.A.'},
 {'Nome de Preg√£o': 'METAL LEVE',
  'Ticker': 'LEVE3',
  'CompanyName': 'MAHLE-METAL LEVE S.A.'},
 {'Nome de Preg√£o': 'MANGELS INDL',
  'Ticker': 'MGEL3',
  'CompanyName': 'MANGELS INDUSTRIAL S.A.'},
 {'Nome de Preg√£o': 'ESTRELA',
  'Ticker': 'ESTR4',
  'CompanyName': 'MANUFATURA DE BRINQUEDOS ESTRELA S.A.'},
 {'Nome de Preg√£o': 'MARCOPOLO',
  'Ticker': 'POMO3',
  'CompanyName': 'MARCOPOLO S.A.'},
 {'Nome de Preg√£o': 'MARFRIG',
  'Ticker': 'ADR',
  'CompanyName': 'MARFRIG GLOBAL FOODS S.A.'},
 {'Nome de Preg√£o': 'LOJAS MARISA',
  'Ticker': 'AMAR3',
  'CompanyName': 'MARISA LOJAS S.A.'},
 {'Nome de Preg√£o': 'MELIUZ', 'Ticker': 'CASH3', 'CompanyName': 'M√âLIUZ S.A.'},
 {'Nome de Preg√£o': 'MELNICK',
  'Ticker': 'MELK3',
  'CompanyName': 'MELNICK DESENVOLVIMENTO IMOBILI√ÅRIO S.A.'},
 {'Nome de Preg√£o': 'METALFRIO',
  'Ticker': 'FRIO3',
  'CompanyName': 'METALFRIO SOLUTIONS S.A.'},
 {'Nome de Preg√£o': 'GERDAU MET',
  'Ticker': 'GOAU3',
  'CompanyName': 'METALURGICA GERDAU S.A.'},
 {'Nome de Preg√£o': 'RIOSULENSE',
  'Ticker': 'RSUL3',
  'CompanyName': 'METALURGICA RIOSULENSE S.A.'},
 {'Nome de Preg√£o': 'METISA',
  'Ticker': 'MTSA3',
  'CompanyName': 'METISA METALURGICA TIMBOENSE S.A.'},
 {'Nome de Preg√£o': 'MILLS',
  'Ticker': 'MILS3',
  'CompanyName': 'MILLS LOCA√á√ÉO. SERVI√áOS E LOG√çSTICA S.A'},
 {'Nome de Preg√£o': 'MINASMAQUINA',
  'Ticker': 'MMAQ3',
  'CompanyName': 'MINASMAQUINAS S.A.'},
 {'Nome de Preg√£o': 'MINERVA',
  'Ticker': 'BEEF3',
  'CompanyName': 'MINERVA S.A.'},
 {'Nome de Preg√£o': 'MINUPAR',
  'Ticker': 'MNPR3',
  'CompanyName': 'MINUPAR PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'MITRE REALTY',
  'Ticker': 'MTRE3',
  'CompanyName': 'MITRE REALTY EMPREENDIMENTOS E PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'MOBLY', 'Ticker': 'MBLY3', 'CompanyName': 'MOBLY S.A.'},
 {'Nome de Preg√£o': 'MONT ARANHA',
  'Ticker': 'MOAR3',
  'CompanyName': 'MONTEIRO ARANHA S.A.'},
 {'Nome de Preg√£o': 'MOURA DUBEUX',
  'Ticker': 'MDNE3',
  'CompanyName': 'MOURA DUBEUX ENGENHARIA S/A'},
 {'Nome de Preg√£o': 'MOVIDA',
  'Ticker': 'MOVI3',
  'CompanyName': 'MOVIDA PARTICIPACOES SA'},
 {'Nome de Preg√£o': 'ESPACOLASER',
  'Ticker': 'ESPA3',
  'CompanyName': 'MPM CORP√ìREOS S.A.'},
 {'Nome de Preg√£o': 'MRS LOGIST',
  'Ticker': 'MRSA3',
  'CompanyName': 'MRS LOGISTICA S.A.'},
 {'Nome de Preg√£o': 'MRV',
  'Ticker': 'MRVE3',
  'CompanyName': 'MRV ENGENHARIA E PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'MULTILASER',
  'Ticker': 'MLAS3',
  'CompanyName': 'GRUPO MULTI S.A.'},
 {'Nome de Preg√£o': 'MULTIPLAN',
  'Ticker': 'MULT3',
  'CompanyName': 'MULTIPLAN - EMPREEND IMOBILIARIOS S.A.'},
 {'Nome de Preg√£o': 'MUNDIAL',
  'Ticker': 'MNDL3',
  'CompanyName': 'MUNDIAL S.A. - PRODUTOS DE CONSUMO'},
 {'Nome de Preg√£o': 'GRUPO NATURA',
  'Ticker': 'NTCO3',
  'CompanyName': 'NATURA &CO HOLDING S.A.'},
 {'Nome de Preg√£o': 'NEOENERGIA',
  'Ticker': 'NEOE3',
  'CompanyName': 'NEOENERGIA VALE DO ITAJA√ç TRANSMISS√ÉO DE ENERGIA'},
 {'Nome de Preg√£o': 'NEOGRID',
  'Ticker': 'NGRD3',
  'CompanyName': 'NEOGRID PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'NEXPE',
  'Ticker': 'NEXP3',
  'CompanyName': 'NEXPE PARTICIPA√á√ïES S.A'},
 {'Nome de Preg√£o': 'NORDON MET',
  'Ticker': 1,
  'CompanyName': 'NORDON INDUSTRIAS METALURGICAS S.A.'},
 {'Nome de Preg√£o': 'NORTCQUIMICA',
  'Ticker': 'NRTQ3',
  'CompanyName': 'NORTEC QU√çMICA S.A.'},
 {'Nome de Preg√£o': 'NUTRIPLANT',
  'Ticker': 'NUTR3',
  'CompanyName': 'NUTRIPLANT INDUSTRIA E COMERCIO S.A.'},
 {'Nome de Preg√£o': 'OCEANPACT',
  'Ticker': 'OPCT3',
  'CompanyName': 'OCEANPACT SERVICOS MARITIMOS S.A.'},
 {'Nome de Preg√£o': 'ODONTOPREV',
  'Ticker': 'ODPV3',
  'CompanyName': 'ODONTOPREV S.A.'},
 {'Nome de Preg√£o': 'OI', 'Ticker': 'OIBR3', 'CompanyName': 'OI S.A.'},
 {'Nome de Preg√£o': 'ONCOCLINICAS',
  'Ticker': 'ONCO3',
  'CompanyName': 'ONCOCLINICAS DO BRASIL SERVICOS MEDICOS  S.A.'},
 {'Nome de Preg√£o': 'ORIZON',
  'Ticker': 'ORVR3',
  'CompanyName': 'ORIZON VALORIZACAO DE RESIDUOS S.A.'},
 {'Nome de Preg√£o': 'OSX BRASIL',
  'Ticker': 'OSXB3',
  'CompanyName': 'OSX BRASIL S.A.'},
 {'Nome de Preg√£o': 'OUROFINO S/A',
  'Ticker': 'OFSA3',
  'CompanyName': 'OURO FINO SAUDE ANIMAL PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'PADTEC',
  'Ticker': 'PDTC3',
  'CompanyName': 'PADTEC HOLDING S.A.'},
 {'Nome de Preg√£o': 'PANATLANTICA',
  'Ticker': 'PATI3',
  'CompanyName': 'PANATLANTICA S.A.'},
 {'Nome de Preg√£o': 'PARANAPANEMA',
  'Ticker': 'PMAM3',
  'CompanyName': 'PARANAPANEMA S.A.'},
 {'Nome de Preg√£o': 'PATRIMAR',
  'Ticker': 0,
  'CompanyName': 'PATRIMAR ENGENHARIA S.A.'},
 {'Nome de Preg√£o': 'PORTOBELLO', 'Ticker': 'PTBL3', 'CompanyName': 'PBG S/A'},
 {'Nome de Preg√£o': 'PDG REALT',
  'Ticker': 'PDGR3',
  'CompanyName': 'PDG REALTY S.A. EMPREEND E PARTICIPACOES'},
 {'Nome de Preg√£o': 'PETZ',
  'Ticker': 'PETZ3',
  'CompanyName': 'PET CENTER COMERCIO  E PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'PETROBRAS',
  'Ticker': 'PETR3',
  'CompanyName': 'PETROLEO BRASILEIRO S.A. PETROBRAS'},
 {'Nome de Preg√£o': 'PETRORECSA',
  'Ticker': 'RECV3',
  'CompanyName': 'PETROREC√îNCAVO S.A.'},
 {'Nome de Preg√£o': 'PETTENATI',
  'Ticker': 'PTNT3',
  'CompanyName': 'PETTENATI S.A. INDUSTRIA TEXTIL'},
 {'Nome de Preg√£o': 'PLANOEPLANO',
  'Ticker': 'PLPL3',
  'CompanyName': 'PLANO & PLANO DESENVOLVIMENTO IMOBILI√ÅRIO S.A.'},
 {'Nome de Preg√£o': 'PLASCAR PART',
  'Ticker': 'B3',
  'CompanyName': 'PLASCAR PARTICIPACOES INDUSTRIAIS S.A.'},
 {'Nome de Preg√£o': 'POLPAR', 'Ticker': 'PPAR3', 'CompanyName': 'POLPAR S.A.'},
 {'Nome de Preg√£o': 'POMIFRUTAS',
  'Ticker': 'FRTA3',
  'CompanyName': 'POMIFRUTAS S/A'},
 {'Nome de Preg√£o': 'PORTO SEGURO',
  'Ticker': 'PSSA3',
  'CompanyName': 'PORTO SEGURO S.A.'},
 {'Nome de Preg√£o': 'POSITIVO TEC',
  'Ticker': 'POSI3',
  'CompanyName': 'POSITIVO TECNOLOGIA S.A.'},
 {'Nome de Preg√£o': 'PRATICA',
  'Ticker': 'PTCA3',
  'CompanyName': 'PRATICA PRODUTOS S.A.'},
 {'Nome de Preg√£o': 'PRINER',
  'Ticker': 'PRNR3',
  'CompanyName': 'PRINER SERVI√áOS INDUSTRIAIS S.A.'},
 {'Nome de Preg√£o': 'PETRORIO', 'Ticker': 'PRIO3', 'CompanyName': 'PRIO S.A.'},
 {'Nome de Preg√£o': 'PROMAN',
  'Ticker': 'PRMN3B',
  'CompanyName': 'PRODUTORES ENERGET.DE MANSO S.A.- PROMAN'},
 {'Nome de Preg√£o': 'PROFARMA',
  'Ticker': 'PFRM3',
  'CompanyName': 'PROFARMA DISTRIB PROD FARMACEUTICOS S.A.'},
 {'Nome de Preg√£o': 'PROMPT PART',
  'Ticker': 'PRPT3B',
  'CompanyName': 'PROMPT PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'QUALICORP',
  'Ticker': 'QUAL3',
  'CompanyName': 'QUALICORP CONSULTORIA E CORRETORA DE SEGUROS S.A.'},
 {'Nome de Preg√£o': 'QUALITY SOFT',
  'Ticker': 'QUSW3',
  'CompanyName': 'QUALITY SOFTWARE S.A.'},
 {'Nome de Preg√£o': 'RAIADROGASIL',
  'Ticker': 'RADL3',
  'CompanyName': 'RAIA DROGASIL S.A.'},
 {'Nome de Preg√£o': 'RAIZEN', 'Ticker': 'RAIZ4', 'CompanyName': 'RAIZEN S.A.'},
 {'Nome de Preg√£o': 'RANDON PART',
  'Ticker': 'RAPT3',
  'CompanyName': 'RANDON S.A. IMPLEMENTOS E PARTICIPACOES'},
 {'Nome de Preg√£o': 'RECRUSUL',
  'Ticker': 'RCSL3',
  'CompanyName': 'RECRUSUL S.A.'},
 {'Nome de Preg√£o': 'REDE D OR',
  'Ticker': 'RDOR3',
  'CompanyName': 'REDE DOR S√ÉO LUIZ S.A.'},
 {'Nome de Preg√£o': 'REDE ENERGIA',
  'Ticker': 'REDE3',
  'CompanyName': 'REDE ENERGIA PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'PET MANGUINH',
  'Ticker': 'RPMG3',
  'CompanyName': 'REFINARIA DE PETROLEOS MANGUINHOS S.A.'},
 {'Nome de Preg√£o': 'RENOVA',
  'Ticker': 'RNEW3',
  'CompanyName': 'RENOVA ENERGIA S.A.'},
 {'Nome de Preg√£o': 'GER PARANAP',
  'Ticker': 'GEPA3',
  'CompanyName': 'RIO PARANAPANEMA ENERGIA S.A.'},
 {'Nome de Preg√£o': 'RNI',
  'Ticker': 'RDNI3',
  'CompanyName': 'RNI NEG√ìCIOS IMOBILI√ÅRIOS S.A.'},
 {'Nome de Preg√£o': 'ROMI', 'Ticker': 'ROMI3', 'CompanyName': 'ROMI S.A.'},
 {'Nome de Preg√£o': 'ROSSI RESID',
  'Ticker': 'RSID3',
  'CompanyName': 'ROSSI RESIDENCIAL S.A.'},
 {'Nome de Preg√£o': 'RUMO S.A.',
  'Ticker': 'RAIL3',
  'CompanyName': 'RUMO S.A.'},
 {'Nome de Preg√£o': 'SANSUY',
  'Ticker': 'SNSY3',
  'CompanyName': 'SANSUY S.A. INDUSTRIA DE PLASTICOS'},
 {'Nome de Preg√£o': 'SANTOS BRP',
  'Ticker': 'STPB3',
  'CompanyName': 'SANTOS BRASIL PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'SAO CARLOS',
  'Ticker': 'SCAR3',
  'CompanyName': 'SAO CARLOS EMPREEND E PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'SAO MARTINHO',
  'Ticker': 'SMTO3',
  'CompanyName': 'SAO MARTINHO S.A.'},
 {'Nome de Preg√£o': 'SPTURIS',
  'Ticker': 'AHEB3',
  'CompanyName': 'SAO PAULO TURISMO S.A.'},
 {'Nome de Preg√£o': 'SCHULZ', 'Ticker': 'SHUL3', 'CompanyName': 'SCHULZ S.A.'},
 {'Nome de Preg√£o': 'ASSAI',
  'Ticker': 'ASAI3',
  'CompanyName': 'SENDAS DISTRIBUIDORA S.A.'},
 {'Nome de Preg√£o': 'SEQUOIA LOG',
  'Ticker': 'SEQL3',
  'CompanyName': 'SEQUOIA LOGISTICA E TRANSPORTES S.A'},
 {'Nome de Preg√£o': 'SER EDUCA',
  'Ticker': 'SEER3',
  'CompanyName': 'SER EDUCACIONAL S.A.'},
 {'Nome de Preg√£o': 'SERENA',
  'Ticker': 'SRNA3',
  'CompanyName': 'SERENA ENERGIA S.A.'},
 {'Nome de Preg√£o': 'ALIPERTI',
  'Ticker': 'APTI3',
  'CompanyName': 'SIDERURGICA J. L. ALIPERTI S.A.'},
 {'Nome de Preg√£o': 'SIMPAR', 'Ticker': 'SIMH3', 'CompanyName': 'SIMPAR S.A.'},
 {'Nome de Preg√£o': 'SLC AGRICOLA',
  'Ticker': 'SLCE3',
  'CompanyName': 'SLC AGRICOLA S.A.'},
 {'Nome de Preg√£o': 'SMART FIT',
  'Ticker': 'SMFT3',
  'CompanyName': 'SMARTFIT ESCOLA DE GIN√ÅSTICA E DAN√áA S.A.'},
 {'Nome de Preg√£o': 'SONDOTECNICA',
  'Ticker': 'SOND3',
  'CompanyName': 'SONDOTECNICA ENGENHARIA SOLOS S.A.'},
 {'Nome de Preg√£o': 'SPRINGS',
  'Ticker': 'SGPS3',
  'CompanyName': 'SPRINGS GLOBAL PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'STATKRAFT',
  'Ticker': 'STKF3',
  'CompanyName': 'STATKRAFT ENERGIAS RENOVAVEIS S.A.'},
 {'Nome de Preg√£o': 'SUDESTE S/A',
  'Ticker': 'OPSE3B',
  'CompanyName': 'SUDESTE S.A.'},
 {'Nome de Preg√£o': 'SUL 116 PART',
  'Ticker': 'OPTS3B',
  'CompanyName': 'SUL 116 PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'SUZANO HOLD',
  'Ticker': 'NEMO3',
  'CompanyName': 'SUZANO HOLDING S.A.'},
 {'Nome de Preg√£o': 'SUZANO S.A.',
  'Ticker': 'SUZB3',
  'CompanyName': 'SUZANO S.A.'},
 {'Nome de Preg√£o': 'SYN PROP TEC',
  'Ticker': 'SYNE3',
  'CompanyName': 'SYN PROP E TECH S.A.'},
 {'Nome de Preg√£o': 'TIME FOR FUN',
  'Ticker': 'SHOW3',
  'CompanyName': 'T4F ENTRETENIMENTO S.A.'},
 {'Nome de Preg√£o': 'TAURUS ARMAS',
  'Ticker': 'TASA3',
  'CompanyName': 'TAURUS ARMAS S.A.'},
 {'Nome de Preg√£o': 'TC', 'Ticker': 'TRAD3', 'CompanyName': 'TC S.A.'},
 {'Nome de Preg√£o': 'TECHNOS',
  'Ticker': 'TECN3',
  'CompanyName': 'TECHNOS S.A.'},
 {'Nome de Preg√£o': 'TECNISA',
  'Ticker': 'TCSA3',
  'CompanyName': 'TECNISA S.A.'},
 {'Nome de Preg√£o': 'TEGMA',
  'Ticker': 'tgma3',
  'CompanyName': 'TEGMA GESTAO LOGISTICA S.A.'},
 {'Nome de Preg√£o': 'TEGRA INCORP',
  'Ticker': 'TEGA',
  'CompanyName': 'TEGRA INCORPORADORA S.A.'},
 {'Nome de Preg√£o': 'TEKA',
  'Ticker': 'TEKA3',
  'CompanyName': 'TEKA-TECELAGEM KUEHNRICH S.A.'},
 {'Nome de Preg√£o': 'TEKNO',
  'Ticker': 'TKNO3',
  'CompanyName': 'TEKNO S.A. - INDUSTRIA E COMERCIO'},
 {'Nome de Preg√£o': 'TELEBRAS',
  'Ticker': 'TELB3',
  'CompanyName': 'TELEC BRASILEIRAS S.A. TELEBRAS'},
 {'Nome de Preg√£o': 'TELEF BRASIL',
  'Ticker': 'VIVT3',
  'CompanyName': 'TELEF√îNICA BRASIL S.A'},
 {'Nome de Preg√£o': 'MENEZES CORT',
  'Ticker': 0,
  'CompanyName': 'TERMINAL GARAGEM MENEZES CORTES S.A.'},
 {'Nome de Preg√£o': 'TERRASANTAPA',
  'Ticker': 'LAND3',
  'CompanyName': 'TERRA SANTA PROPRIEDADES AGRICOLAS S.A.'},
 {'Nome de Preg√£o': 'TEX RENAUX',
  'Ticker': 'TRXR3',
  'CompanyName': 'TEXTIL RENAUXVIEW S.A.'},
 {'Nome de Preg√£o': 'TIM', 'Ticker': 'TIMS3', 'CompanyName': 'TIM S.A.'},
 {'Nome de Preg√£o': 'TOTVS', 'Ticker': 'TOTS3', 'CompanyName': 'TOTVS S.A.'},
 {'Nome de Preg√£o': 'TRIUNFO PART',
  'Ticker': 'TPIS3',
  'CompanyName': 'TPI - TRIUNFO PARTICIP. E INVEST. S.A.'},
 {'Nome de Preg√£o': 'TRACK FIELD',
  'Ticker': 'TFCO4',
  'CompanyName': 'TRACK & FIELD CO S.A.'},
 {'Nome de Preg√£o': 'TAESA',
  'Ticker': 'TAEE3',
  'CompanyName': 'TRANSMISSORA ALIAN√áA DE ENERGIA EL√âTRICA S.A.'},
 {'Nome de Preg√£o': '3TENTOS',
  'Ticker': 'TTEN3',
  'CompanyName': 'TR√äS TENTOS AGROINDUSTRIAL S/A'},
 {'Nome de Preg√£o': 'TREVISA',
  'Ticker': 8192,
  'CompanyName': 'TREVISA INVESTIMENTOS S.A.'},
 {'Nome de Preg√£o': 'TRIPLE PLAY',
  'Ticker': 0,
  'CompanyName': 'TRIPLE PLAY BRASIL PARTICIPA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'TRISUL', 'Ticker': 'TRIS3', 'CompanyName': 'TRISUL S.A.'},
 {'Nome de Preg√£o': 'CRISTAL',
  'Ticker': 'CRPG3',
  'CompanyName': 'TRONOX PIGMENTOS DO BRASIL S.A.'},
 {'Nome de Preg√£o': 'TUPY', 'Ticker': 'TUPY3', 'CompanyName': 'TUPY S.A.'},
 {'Nome de Preg√£o': 'ULTRAPAR',
  'Ticker': 'UGPA3',
  'CompanyName': 'ULTRAPAR PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'UNICASA',
  'Ticker': 'UCAS3',
  'CompanyName': 'UNICASA IND√öSTRIA DE M√ìVEIS S.A.'},
 {'Nome de Preg√£o': 'UNIFIQUE',
  'Ticker': 'FIQE3',
  'CompanyName': 'UNIFIQUE TELECOMUNICA√á√ïES S.A.'},
 {'Nome de Preg√£o': 'UNIPAR',
  'Ticker': 'UNIP3',
  'CompanyName': 'UNIPAR CARBOCLORO S.A.'},
 {'Nome de Preg√£o': 'UPTICK',
  'Ticker': 'UPKP3B',
  'CompanyName': 'UPTICK PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'USIMINAS',
  'Ticker': 'USIM3',
  'CompanyName': 'USINAS SID DE MINAS GERAIS S.A.-USIMINAS'},
 {'Nome de Preg√£o': 'VALE', 'Ticker': 'VALE3', 'CompanyName': 'VALE S.A.'},
 {'Nome de Preg√£o': 'VALID',
  'Ticker': 'VLID3',
  'CompanyName': 'VALID SOLU√á√ïES S.A.'},
 {'Nome de Preg√£o': 'VAMOS',
  'Ticker': 'VAMO3',
  'CompanyName': 'VAMOS LOCA√á√ÉO DE CAMINH√ïES. M√ÅQUINAS E EQUIP. S.A.'},
 {'Nome de Preg√£o': 'VESTE',
  'Ticker': 'VSTE3',
  'CompanyName': 'VESTE S.A. ESTILO'},
 {'Nome de Preg√£o': 'VIBRA',
  'Ticker': 'VBBR3',
  'CompanyName': 'VIBRA ENERGIA S.A.'},
 {'Nome de Preg√£o': 'VITTIA', 'Ticker': 'VITT3', 'CompanyName': 'VITTIA S.A.'},
 {'Nome de Preg√£o': 'VIVARA S.A.',
  'Ticker': 'VIVA3',
  'CompanyName': 'VIVARA PARTICIPA√áOES S.A'},
 {'Nome de Preg√£o': 'VIVER',
  'Ticker': 'VIVR3',
  'CompanyName': 'VIVER INCORPORADORA E CONSTRUTORA S.A.'},
 {'Nome de Preg√£o': 'VULCABRAS',
  'Ticker': 'VULC3',
  'CompanyName': 'VULCABRAS S.A.'},
 {'Nome de Preg√£o': 'WEG', 'Ticker': 'WEGE3', 'CompanyName': 'WEG S.A.'},
 {'Nome de Preg√£o': 'WESTWING',
  'Ticker': 'WEST3',
  'CompanyName': 'WESTWING COMERCIO VAREJISTA S.A.'},
 {'Nome de Preg√£o': 'WETZEL S/A',
  'Ticker': 'MWET3',
  'CompanyName': 'WETZEL S.A.'},
 {'Nome de Preg√£o': 'WHIRLPOOL',
  'Ticker': 'WHRL3',
  'CompanyName': 'WHIRLPOOL S.A.'},
 {'Nome de Preg√£o': 'WILSON SONS',
  'Ticker': 'PORT3',
  'CompanyName': 'WILSON SONS S.A.'},
 {'Nome de Preg√£o': 'WIZ CO',
  'Ticker': 'WIZC3',
  'CompanyName': 'WIZ CO PARTICIPA√á√ïES E CORRETAGEM DE SEGUROS S.A.'},
 {'Nome de Preg√£o': 'WLM IND COM',
  'Ticker': 'WLMM3',
  'CompanyName': 'WLM PART. E COM√âRCIO DE M√ÅQUINAS E VE√çCULOS S.A.'},
 {'Nome de Preg√£o': 'YBYRA S/A',
  'Ticker': 'YBRA3',
  'CompanyName': 'YBYR√Å CAPITAL S.A.'},
 {'Nome de Preg√£o': 'YDUQS PART',
  'Ticker': 'YDUQ3',
  'CompanyName': 'YDUQS PARTICIPACOES S.A.'},
 {'Nome de Preg√£o': 'ZAMP S.A.',
  'Ticker': 'ZAMP3',
  'CompanyName': 'ZAMP S.A.'}]

# Fun√ß√£o para buscar dados hist√≥ricos de a√ß√µes via yfinance
def buscar_dados_acoes(tickers_input, data_inicio_input, data_fim_input):
    data_inicio = datetime.strptime(data_inicio_input, "%d/%m/%Y").strftime("%Y-%m-%d")
    data_fim = datetime.strptime(data_fim_input, "%d/%m/%Y").strftime("%Y-%m-%d")
    data_fim_ajustada = (datetime.strptime(data_fim, "%Y-%m-%d") + timedelta(days=1)).strftime("%Y-%m-%d")
    
    tickers = [
        ticker.strip() + '.SA' if any(char.isdigit() for char in ticker.strip()) and not ticker.strip().endswith('.SA')
        else ticker.strip()
        for ticker in tickers_input.split(",")
    ]

    dados_acoes_dict = {}
    erros = []

    for ticker in tickers:
        try:
            dados = yf.download(ticker, start=data_inicio, end=data_fim_ajustada, auto_adjust=False)
            if not dados.empty:
                dados.reset_index(inplace=True)
                dados['Ticker'] = ticker
                dados['Date'] = dados['Date'].dt.strftime('%d/%m/%Y')
                dados_acoes_dict[ticker] = dados
            else:
                erros.append(f"Sem dados para o ticker {ticker}")
        except Exception as e:
            erros.append(f"Erro ao buscar dados para {ticker}: {e}")
    
    return dados_acoes_dict, erros

# Fun√ß√£o para calcular volatilidade hist√≥rica e GARCH
def calcular_volatilidade(df):
    df = df.sort_values(by='Date', ascending=False).copy()
    volatilidade_historica = {}
    volatilidade_garch = {}
    
    periodos_dias = {1: 252, 2: 509, 3: 761, 4: 1000, 5: 1250, 6: 1500, 7: 1750, 8: 2000, 9: 2250, 10: 2500}
    
    for years, dias in periodos_dias.items():
        df_period = df.head(dias).copy()
        df_period['Retornos_Log'] = np.log(df_period['Close'] / df_period['Close'].shift(1))
        df_period = df_period.dropna()
        
        if df_period.empty or len(df_period) < 30:
            volatilidade_historica[years] = np.nan
            volatilidade_garch[years] = np.nan
            continue
        
        vol_anualizada_hist = df_period['Retornos_Log'].std(ddof=1) * np.sqrt(252)
        volatilidade_historica[years] = vol_anualizada_hist
        
        try:
            model = arch_model(df_period['Retornos_Log'] * 10, vol='Garch', p=1, q=1)
            garch_result = model.fit(disp='off')
            vol_diaria_media = garch_result.conditional_volatility.mean() / 10
            vol_anualizada_garch = vol_diaria_media * np.sqrt(252)
            volatilidade_garch[years] = vol_anualizada_garch
        except:
            volatilidade_garch[years] = np.nan
    
    df_volatilidade = pd.DataFrame({
        'Volatilidade Hist√≥rica': pd.Series(volatilidade_historica),
        'Volatilidade GARCH(1,1)': pd.Series(volatilidade_garch)
    })
    df_volatilidade.index.name = 'Per√≠odo (Anos)'
    return df_volatilidade

# Interface do Streamlit
st.title('Consulta dados hist√≥ricos de A√ß√µes, Dividendos e Volatilidade')

# Entrada do usu√°rio
tickers_input = st.text_input("Digite os tickers separados por v√≠rgula (ex: PETR4, VALE3, ^BVSP):")
data_inicio_input = st.text_input("Digite a data de in√≠cio (dd/mm/aaaa):")
data_fim_input = st.text_input("Digite a data de fim (dd/mm/aaaa):")
buscar_dividendos = st.checkbox("Adicionar os dividendos no per√≠odo")
buscar_volatilidade = st.checkbox("Calcular volatilidade hist√≥rica e GARCH")

# Bot√£o para buscar dados
if st.button('Buscar Dados'):
    if tickers_input and data_inicio_input and data_fim_input:
        dados_acoes_dict, erros = buscar_dados_acoes(tickers_input, data_inicio_input, data_fim_input)
        
        for erro in erros:
            st.info(erro)
        
        if not dados_acoes_dict:
            st.info("Nenhum dado de a√ß√µes encontrado para os tickers e per√≠odo especificados.")
        else:
            st.write("### Dados de A√ß√µes por Ticker:")
            for ticker, df_acao in dados_acoes_dict.items():
                st.write(f"#### {ticker}")
                st.dataframe(df_acao)
                
                if buscar_volatilidade:
                    df_volatilidade = calcular_volatilidade(df_acao)
                    st.write(f"### Volatilidade de {ticker}")
                    st.dataframe(df_volatilidade)
        
        # Exportar para Excel
        # Nome do arquivo de sa√≠da
nome_arquivo = "dados_acoes_dividendos_volatilidade.xlsx"

with pd.ExcelWriter(nome_arquivo) as writer:
    # 1Ô∏è‚É£ Gravar dados de a√ß√µes (cada ticker em uma aba)
    for ticker, df_acao in dados_acoes_dict.items():
        # sheet_name n√£o pode ter mais de 31 caracteres no Excel
        sheet_name = f"Acoes_{ticker[:25]}"
        
        # üö® Corrigir poss√≠veis MultiIndex ou colunas aninhadas
        df_acao = df_acao.reset_index(drop=True)
        df_acao.columns = [str(col) for col in df_acao.columns]  # Garantir colunas simples
        
        df_acao.to_excel(writer, sheet_name=sheet_name, index=False)

    # 2Ô∏è‚É£ Gravar dividendos, se dispon√≠veis
    if buscar_dividendos and dados_dividendos_dict:
        for ticker, df_divid in dados_dividendos_dict.items():
            sheet_name = f"Div_{ticker[:25]}"
            df_divid.to_excel(writer, sheet_name=sheet_name, index=False)

    # 3Ô∏è‚É£ Gravar os c√°lculos de volatilidade por ticker
    if calcular_volatilidade and dados_volatilidade_dict:
        for ticker, df_volatilidade in dados_volatilidade_dict.items():
            sheet_name = f"Vol_{ticker[:25]}"
            df_volatilidade.to_excel(writer, sheet_name=sheet_name, index=False)

# Bot√£o para baixar o Excel no Streamlit
with open(nome_arquivo, 'rb') as file:
    st.download_button(
        label="Baixar arquivo Excel",
        data=file,
        file_name=nome_arquivo
    )
